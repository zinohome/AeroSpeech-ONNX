# STT和TTS模型文件清单

## 概述

本文档列出了STT（语音转文本）和TTS（文本转语音）服务运行和测试所需的所有模型文件。

## STT模型文件

### 必需文件

#### 1. ASR模型文件
- **文件路径**: `models/asr/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17/model.int8.onnx`
- **下载地址**: https://huggingface.co/csukuangfj/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17/resolve/main/model.int8.onnx
- **说明**: SenseVoice多语言ASR模型（int8量化版本，体积更小）
- **用途**: 语音识别核心模型
- **大小**: 约100-200MB

#### 2. ASR Tokens文件
- **文件路径**: `models/asr/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17/tokens.txt`
- **下载地址**: https://huggingface.co/csukuangfj/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17/resolve/main/tokens.txt
- **说明**: 词汇表文件，包含所有可能的token
- **用途**: 模型解码必需
- **大小**: 约几KB到几MB

### 可选文件

#### 3. 说话人识别模型
- **文件路径**: `models/speaker/3dspeaker_speech_campplus_sv_zh_en_16k-common_advanced.onnx`
- **下载地址**: https://huggingface.co/csukuangfj/speaker-embedding-models/resolve/main/3dspeaker_speech_campplus_sv_zh_en_16k-common_advanced.onnx
- **说明**: 说话人识别/区分模型
- **用途**: 用于说话人识别功能（如果不需要可以省略）
- **大小**: 约几十MB

## TTS模型文件

### 必需文件

#### 1. TTS模型文件
- **文件路径**: `models/tts/kokoro-multi-lang-v1_0/model.onnx`
- **下载地址**: https://huggingface.co/csukuangfj/kokoro-multi-lang-v1_0/resolve/main/model.onnx
- **说明**: Kokoro多语言TTS模型
- **用途**: 文本转语音核心模型
- **大小**: 约100-200MB

#### 2. TTS Tokens文件
- **文件路径**: `models/tts/kokoro-multi-lang-v1_0/tokens.txt`
- **下载地址**: https://huggingface.co/csukuangfj/kokoro-multi-lang-v1_0/resolve/main/tokens.txt
- **说明**: 词汇表文件
- **用途**: 模型解码必需
- **大小**: 约几KB到几MB

### 可选文件（用于增强功能）

#### 3. TTS Voices文件
- **文件路径**: `models/tts/kokoro-multi-lang-v1_0/voices.bin`
- **下载地址**: https://huggingface.co/csukuangfj/kokoro-multi-lang-v1_0/resolve/main/voices.bin
- **说明**: 多说话人声音文件
- **用途**: 支持多说话人TTS（如果只需要单一声音可以省略）
- **大小**: 约几MB

#### 4. espeak-ng-data目录
- **文件路径**: `models/tts/kokoro-multi-lang-v1_0/espeak-ng-data/`
- **下载地址**: https://huggingface.co/csukuangfj/kokoro-multi-lang-v1_0/tree/main/espeak-ng-data
- **说明**: 文本处理数据目录
- **用途**: 用于文本到音素的转换（如果模型不需要可以省略）
- **大小**: 约几MB到几十MB

#### 5. dict目录
- **文件路径**: `models/tts/kokoro-multi-lang-v1_0/dict/`
- **下载地址**: https://huggingface.co/csukuangfj/kokoro-multi-lang-v1_0/tree/main/dict
- **说明**: 字典文件目录
- **用途**: 用于文本处理（如果模型不需要可以省略）
- **大小**: 约几MB

#### 6. Lexicon文件
- **文件路径**: 
  - `models/tts/kokoro-multi-lang-v1_0/lexicon-us-en.txt`
  - `models/tts/kokoro-multi-lang-v1_0/lexicon-zh.txt`
- **下载地址**: 
  - https://huggingface.co/csukuangfj/kokoro-multi-lang-v1_0/resolve/main/lexicon-us-en.txt
  - https://huggingface.co/csukuangfj/kokoro-multi-lang-v1_0/resolve/main/lexicon-zh.txt
- **说明**: 词汇表文件
- **用途**: 用于文本处理（如果模型不需要可以省略）
- **大小**: 约几MB

## 最小化配置（仅用于测试）

如果只需要运行基本测试，可以只下载以下文件：

### STT最小配置
1. `models/asr/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17/model.int8.onnx`
2. `models/asr/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17/tokens.txt`

### TTS最小配置
1. `models/tts/kokoro-multi-lang-v1_0/model.onnx`
2. `models/tts/kokoro-multi-lang-v1_0/tokens.txt`

## 下载方式

### 方式1：使用下载脚本（推荐）

```bash
# 运行下载脚本
./scripts/download_models.sh
```

### 方式2：手动下载

使用curl或wget下载各个文件：

```bash
# 创建目录
mkdir -p models/asr/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17
mkdir -p models/tts/kokoro-multi-lang-v1_0

# 下载STT模型
curl -L -o models/asr/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17/model.int8.onnx \
  https://huggingface.co/csukuangfj/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17/resolve/main/model.int8.onnx

curl -L -o models/asr/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17/tokens.txt \
  https://huggingface.co/csukuangfj/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17/resolve/main/tokens.txt

# 下载TTS模型
curl -L -o models/tts/kokoro-multi-lang-v1_0/model.onnx \
  https://huggingface.co/csukuangfj/kokoro-multi-lang-v1_0/resolve/main/model.onnx

curl -L -o models/tts/kokoro-multi-lang-v1_0/tokens.txt \
  https://huggingface.co/csukuangfj/kokoro-multi-lang-v1_0/resolve/main/tokens.txt
```

## 配置文件设置

下载完成后，需要在配置文件中设置正确的路径：

### STT配置 (configs/stt-config.json)
```json
{
  "asr": {
    "model_path": "models/asr/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17/model.int8.onnx",
    "tokens_path": "models/asr/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17/tokens.txt",
    "language": "zh"
  }
}
```

### TTS配置 (configs/tts-config.json)
```json
{
  "tts": {
    "model_path": "models/tts/kokoro-multi-lang-v1_0/model.onnx",
    "tokens_path": "models/tts/kokoro-multi-lang-v1_0/tokens.txt",
    "voices_path": "models/tts/kokoro-multi-lang-v1_0/voices.bin"
  }
}
```

## 测试验证

下载完成后，可以使用以下命令验证文件：

```bash
# 检查STT模型文件
ls -lh models/asr/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17/

# 检查TTS模型文件
ls -lh models/tts/kokoro-multi-lang-v1_0/

# 运行测试（需要设置环境变量）
export ASR_MODEL_PATH=models/asr/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17/model.int8.onnx
export ASR_TOKENS_PATH=models/asr/sherpa-onnx-sense-voice-zh-en-ja-ko-yue-2024-07-17/tokens.txt
export TTS_MODEL_PATH=models/tts/kokoro-multi-lang-v1_0/model.onnx
export TTS_TOKENS_PATH=models/tts/kokoro-multi-lang-v1_0/tokens.txt

go test ./internal/asr -v
go test ./internal/tts -v
```

## 注意事项

1. **文件大小**: 模型文件较大（每个约100-200MB），下载需要一定时间
2. **网络要求**: 需要能够访问HuggingFace（可能需要代理）
3. **存储空间**: 确保有足够的磁盘空间（建议至少1GB）
4. **文件完整性**: 下载后建议验证文件大小，确保下载完整
5. **可选文件**: 如果某些可选文件下载失败，不影响基本功能测试

## 文件大小参考

- ASR模型 (model.int8.onnx): ~100-200MB
- ASR Tokens (tokens.txt): ~几KB到几MB
- TTS模型 (model.onnx): ~100-200MB
- TTS Tokens (tokens.txt): ~几KB到几MB
- TTS Voices (voices.bin): ~几MB
- 说话人识别模型: ~几十MB

**总计（最小配置）**: 约200-400MB
**总计（完整配置）**: 约300-500MB

